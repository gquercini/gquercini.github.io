<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Gianluca Quercini">

  
  
  
    
  
  <meta name="description" content="Normalization theory exercises">

  
  <link rel="alternate" hreflang="en-us" href="/courses/gadexed_en/tutorials/normalization/">

  


  
  
  
  <meta name="theme-color" content="rgb(0, 136, 204)">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  


  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu68b06f59cdf252d86e7129a31e131766_426695_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu68b06f59cdf252d86e7129a31e131766_426695_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="/courses/gadexed_en/tutorials/normalization/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Gianluca Quercini">
  <meta property="og:url" content="/courses/gadexed_en/tutorials/normalization/">
  <meta property="og:title" content="Normalization theory | Gianluca Quercini">
  <meta property="og:description" content="Normalization theory exercises"><meta property="og:image" content="img/map[gravatar:%!s(bool=true) shape:circle]">
  <meta property="twitter:image" content="img/map[gravatar:%!s(bool=true) shape:circle]"><meta property="og:locale" content="en-us">
  
    
    
  

  



  


  


  





  <title>Normalization theory | Gianluca Quercini</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Gianluca Quercini</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Gianluca Quercini</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#experience"><span>Experience</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#teaching"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      

      

      

    </ul>

  </div>
</nav>


  

  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      


<script src="/js/toggle-menu.js"></script>







  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">

    <a onclick=open_menu_on_click(this) id="tutorials" class="docs-toc-link" href="/courses/gadexed_en/tutorials/01-rel-data-modeling/">Tutorials</a>
    
    <div id="tutorials-ddowncontent" class="tutorials-ddowncontent ddowncontent">
    <ul class="nav docs-sidenav">
      
      
      <li class="tutorials">
        <a href="/courses/gadexed_en/tutorials/01-rel-data-modeling/">1. Relational data modeling</a>
      </li>
      
      <script>open_menu_on_load("tutorials".concat("-ddowncontent"))</script>
      <li class="active tutorials">
        <a href="/courses/gadexed_en/tutorials/normalization/">2. Normalization theory</a>
      </li>
      
      
      <li class="tutorials">
        <a href="/courses/gadexed_en/tutorials/02-sql/">2. SQL</a>
      </li>
      
      
      <li class="tutorials">
        <a href="/courses/gadexed_en/tutorials/data-warehouse/">4. Data warehousing</a>
      </li>
      
      
      <li class="tutorials">
        <a href="/courses/gadexed_en/tutorials/mongodb-data-modeling/">5. Data modeling in MongoDB</a>
      </li>
      
      
      <li class="tutorials">
        <a href="/courses/gadexed_en/tutorials/mongodb-queries/">6. Queries in MongoDB</a>
      </li>
      
      
      <li class="tutorials">
        <a href="/courses/gadexed_en/tutorials/neo4j/">7. Neo4j</a>
      </li>
      
      
      <li class="tutorials">
        <a href="/courses/gadexed_en/tutorials/cassandra-data-modeling/">8. Data modeling in Cassandra</a>
      </li>
      
      
      <li class="tutorials">
        <a href="/courses/gadexed_en/tutorials/cassandra-queries/">9. Queries in Cassandra</a>
      </li>
      
    </ul>
    </div>
    
    

  </div>
  
  
</nav>

    </div>

    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <div class="heading">Gestion et analyse des données — Tutorial 2</div>
          <h1>Normalization theory</h1>
          <hr>
          <div class="logo">
            
            </div>

          <div class="article-style">
            


<p><link rel="stylesheet" href="/styles/course.css">
<link rel="stylesheet" href="/styles/cloud-computing.css"></p>
<p>In this tutorial you’ll learn:</p>
<ul>
<li>How to obtain a <strong>non-redundant set of functional dependencies</strong>.</li>
<li>How to determine the <strong>candidate keys</strong> of a table given its functional dependencies.</li>
<li>How to determine the <strong>normal form</strong> of a table.</li>
</ul>
<div id="question-1" class="section level1">
<h1>Question 1</h1>
<p>We consider a relational table <span class="math inline">\(R\)</span> with four columns <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span>.
Let <span class="math inline">\(\mathcal{F}\)</span> be the following set of functional dependencies:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(AB \rightarrow C\)</span></p></li>
<li><p><span class="math inline">\(D \rightarrow BC\)</span></p></li>
<li><p><span class="math inline">\(A \rightarrow B\)</span></p></li>
</ol>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-1" class="exercise"><strong>Exercise 1  </strong></span>
Derive a minimal set <span class="math inline">\(\mathcal{G}\)</span> of functional dependencies that is equivalent to <span class="math inline">\(\mathcal{F}\)</span>.</p>
</div>
</div>
<details>
<p><summary>Solution</summary></p>
<div class="infobox exosolution">
<p>We first need to write the functional dependencies in canonical form
(the right-side of each FD must consist of only one column).</p>
<p>The FD (2.) can be rewritten using the decomposition axiom.</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(AB \rightarrow C\)</span></p></li>
<li><p><span class="math inline">\(D \rightarrow B\)</span></p></li>
<li><p><span class="math inline">\(D \rightarrow C\)</span></p></li>
<li><p><span class="math inline">\(A \rightarrow B\)</span></p></li>
</ol>
<p>Next, we need to make sure that all functional dependencies are left-irreducible.</p>
<p>All functional dependencies except the first one is trivially left-irreducible (the determinant consists of
only one column).
The first has two columns in the determinant, therefore we need to check whether we
can eliminate one of the two columns and still preserve an equivalent set of functional dependencies.</p>
<p>We apply Armstrong’s axioms to compute the closure of this set of functional dependencies.</p>
<p>From (1.) and (4.), we can apply the pseudotransitivity axiom and we obtain:</p>
<p><span class="math display">\[A \rightarrow B \wedge AB \rightarrow C \implies AA \rightarrow C \implies A \rightarrow C\]</span></p>
<p>Since <span class="math inline">\(A \rightarrow C\)</span> is in the cover, the column <span class="math inline">\(B\)</span> in FD (1.) is useless
and can therefore be omitted.</p>
<p>The set <span class="math inline">\(\mathcal{G}\)</span> consists of the following FDs:</p>
<ul>
<li><p><span class="math inline">\(A \rightarrow C\)</span></p></li>
<li><p><span class="math inline">\(D \rightarrow B\)</span></p></li>
<li><p><span class="math inline">\(D \rightarrow C\)</span></p></li>
<li><p><span class="math inline">\(A \rightarrow B\)</span></p></li>
</ul>
<p>None of these functional dependencies are redundant.</p>
</div>
</details>
</div>
<div id="question-2" class="section level1">
<h1>Question 2</h1>
<p>Let <span class="math inline">\(R\)</span> be a relational table with five columns <span class="math inline">\((A, B, C, D, E)\)</span>.
The following set <span class="math inline">\(\mathcal{F}\)</span> of functional dependencies hold:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(AB \rightarrow C\)</span></li>
<li><span class="math inline">\(C \rightarrow A\)</span></li>
<li><span class="math inline">\(C \rightarrow B\)</span></li>
<li><span class="math inline">\(C \rightarrow D\)</span></li>
<li><span class="math inline">\(D \rightarrow E\)</span></li>
</ol>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-2" class="exercise"><strong>Exercise 2  </strong></span>
Specify the candidate keys of the table <span class="math inline">\(R\)</span>.</p>
</div>
</div>
<details>
<p><summary>Solution</summary></p>
<div class="infobox exosolution">
<p>A candidate key is a set of columns that imply all the other columns.</p>
<p>First, let’s try sets composed of only one column: <span class="math inline">\(\{A\}\)</span>, <span class="math inline">\(\{B\}\)</span>,
<span class="math inline">\(\{C\}\)</span>, <span class="math inline">\(\{D\}\)</span> and <span class="math inline">\(\{E\}\)</span>.</p>
<p>We have the following: (<span class="math inline">\(\{X\}^+_{\mathcal{F}}\)</span> indicates the set of all columns implied by <span class="math inline">\(X\)</span>).</p>
<ul>
<li><p><span class="math inline">\(\{A\}^+_{\mathcal{F}} = \{A\}\)</span></p></li>
<li><p><span class="math inline">\(\{B\}^+_{\mathcal{F}} = \{B\}\)</span></p></li>
<li><p><span class="math inline">\(\{C\}^+_{\mathcal{F}} = \{A, B, C, D, E\}\)</span></p></li>
<li><p><span class="math inline">\(\{D\}^+_{\mathcal{F}} = \{D, E\}\)</span></p></li>
<li><p><span class="math inline">\(\{E\}^+_{\mathcal{F}} = \{E\}\)</span></p></li>
</ul>
<p>Therefore, <span class="math inline">\(\{C\}\)</span> is a candidate key because it implies all the other columns.</p>
<p>From the functional dependency (1), we obtain that <span class="math inline">\(AB\)</span> implies <span class="math inline">\(C\)</span>; therefore,
by transitivity they imply all the other columns.</p>
<p>In conclusion, we have two candidate keys: <span class="math inline">\(\{C\}\)</span> and <span class="math inline">\(\{A, B\}\)</span>.</p>
</div>
</details>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-3" class="exercise"><strong>Exercise 3  </strong></span>
We assume that <span class="math inline">\(R\)</span> is in 1NF.</p>
<ul>
<li><p>Is table <span class="math inline">\(R\)</span> in 2NF? Justify your answer.</p></li>
<li><p>Is table <span class="math inline">\(R\)</span> in 3NF? Justify your answer.</p></li>
<li>Is table <span class="math inline">\(R\)</span> in BCNF? Justify your answer.</li>
</ul>
</div>
</div>
<details>
<p><summary>Solution</summary></p>
<div class="infobox exosolution">
<ul>
<li><p><span class="math inline">\(R\)</span> is in 2NF. In fact, all non-prime columns depend
entirely on both candidate keys.</p></li>
<li><p><span class="math inline">\(R\)</span> is not in 3NF. In fact, the functional dependency <span class="math inline">\(D \rightarrow E\)</span> is
between two non-prime columns.</p></li>
<li><p>As a result, <span class="math inline">\(R\)</span> is not in BCNF either.</p></li>
</ul>
</div>
</details>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-4" class="exercise"><strong>Exercise 4  </strong></span>
If the table <span class="math inline">\(R\)</span> from the previous exercise is not in BCNF,
how would you change the schema so that BCNF is satisfied?
For each table, specify the primary key and the foreign keys
linking the tables to each other.</p>
</div>
</div>
<details>
<p><summary>Solution</summary></p>
<div class="infobox exosolution">
<p>The table is not in 3NF.
The offending functional dependency is <span class="math inline">\(D \rightarrow E\)</span>.</p>
<p>We need to create a new table <span class="math inline">\(R_1\)</span>, where the primary key is
the determinant in the offending functional dependency (<span class="math inline">\(D\)</span>).
We then move all columns that are dependent on <span class="math inline">\(D\)</span> (only <span class="math inline">\(E\)</span> in our case) from <span class="math inline">\(R\)</span> to <span class="math inline">\(R_1\)</span>.
Note that <span class="math inline">\(D\)</span> is kept in <span class="math inline">\(R\)</span> so that we can use it to link
<span class="math inline">\(R\)</span> with <span class="math inline">\(R_1\)</span>.</p>
<p>In summary:</p>
<p><span class="math display">\[R = \{A, B, C, D\}\]</span></p>
<p><span class="math display">\[R_1 = \{D, E\}\]</span></p>
<p>The primary key of <span class="math inline">\(R\)</span> is <span class="math inline">\(\{C\}\)</span> (or, we can also choose <span class="math inline">\(\{A, B\}\)</span> if we want).
The primary key of <span class="math inline">\(R_1\)</span> is <span class="math inline">\(\{D\}\)</span>.</p>
<p>The column <span class="math inline">\(D\)</span> in <span class="math inline">\(R\)</span> is a foreign key referencing the column <span class="math inline">\(D\)</span> in <span class="math inline">\(R_1\)</span>.</p>
</div>
</details>
</div>
<div id="question-3" class="section level1">
<h1>Question 3</h1>
<p>Let <span class="math inline">\(R\)</span> be a relational table with four columns
<span class="math inline">\((A, B, C, D)\)</span>. <span class="math inline">\(\{A, B\}\)</span> is the only candidate key.</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-5" class="exercise"><strong>Exercise 5  </strong></span>
Identify a minimal set of functional dependencies.
Justify your answer.</p>
</div>
</div>
<details>
<p><summary>Solution</summary></p>
<div class="infobox exosolution">
<p>A candidate key implies all the other columns of the table.
Therefore we have :</p>
<p><span class="math display">\[AB \rightarrow C\]</span>
<span class="math display">\[AB \rightarrow D\]</span></p>
<p>Both functional dependencies are in canonical form (the right side only consist of one column).
Trivially, both functional dependencies are left-irreducible (we cannot remove any of the columns
in the determinant without losing information).
So, this is a minimal set of functional dependencies.</p>
</div>
</details>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-6" class="exercise"><strong>Exercise 6  </strong></span>
Add <span class="math inline">\(B \rightarrow D\)</span> to the set of functional dependencies that you identified
in the previous exercise.
Modify the minimal set of functional dependencies accordingly.
Justify your answer.</p>
</div>
</div>
<details>
<p><summary>Solution</summary></p>
<div class="infobox exosolution">
<p>We consider the following functional dependencies:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(AB \rightarrow C\)</span></li>
<li><span class="math inline">\(AB \rightarrow D\)</span></li>
<li><span class="math inline">\(B \rightarrow D\)</span></li>
</ol>
<p>The FD (3) clearly makes FD (2) redundant.
By using the augmentation axiom on (3) we obtain:</p>
<ol start="4" style="list-style-type: decimal">
<li><span class="math inline">\(AB \rightarrow AD\)</span></li>
</ol>
<p>By applying the decomposition axiom on (4) we obtain:</p>
<ol start="5" style="list-style-type: decimal">
<li><p><span class="math inline">\(AB \rightarrow A\)</span></p></li>
<li><p><span class="math inline">\(AB \rightarrow D\)</span></p></li>
</ol>
<p>Which shows that (2) is redundant.</p>
<p>In summary, we have the following functional dependencies:</p>
<p><span class="math display">\[AB\rightarrow C \]</span>
<span class="math display">\[B\rightarrow D \]</span></p>
</div>
</details>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-7" class="exercise"><strong>Exercise 7  </strong></span>
We assume that <span class="math inline">\(R\)</span> is in 1NF.</p>
<ul>
<li><p>Is table <span class="math inline">\(R\)</span> in 2NF? Justify your answer.</p></li>
<li><p>Is table <span class="math inline">\(R\)</span> in 3NF? Justify your answer.</p></li>
<li>Is table <span class="math inline">\(R\)</span> in BCNF? Justify your answer.</li>
</ul>
</div>
</div>
<details>
<p><summary>Solution</summary></p>
<div class="infobox exosolution">
<ul>
<li><p><span class="math inline">\(R\)</span> is not in 2NF. In fact, the non-prime column <span class="math inline">\(C\)</span> is functionally dependent on
only one part of the candidate key.</p></li>
<li><p><span class="math inline">\(R\)</span> is not in 3NF, let alone BCNF, because it doesn’t fulfill the first condition, that is
being in 2NF.</p></li>
</ul>
</div>
</details>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-8" class="exercise"><strong>Exercise 8  </strong></span>
Normalize <span class="math inline">\(R\)</span> to the BCNF form.
Justify your choices.</p>
</div>
</div>
<details>
<p><summary>Solution</summary></p>
<div class="infobox exosolution">
<p>The functional dependency that gives a partial dependency is:
<span class="math inline">\(B \rightarrow D\)</span>.
We create a new table <span class="math inline">\(R_1\)</span>, where the determinant (<span class="math inline">\(B\)</span>) of the
offending functional dependency is the primary key.
We move the columns that depend on <span class="math inline">\(B\)</span> (here, only <span class="math inline">\(D\)</span>) from table
<span class="math inline">\(R\)</span> to table <span class="math inline">\(R_1\)</span>.</p>
<p>In summary:</p>
<p><span class="math display">\[R = (A, B, C)\]</span></p>
<p><span class="math display">\[R_1 = (B, D)\]</span></p>
<p>We can see that <span class="math inline">\(R\)</span> is in 3NF because:</p>
<ul>
<li>The only non-prime column is <span class="math inline">\(C\)</span>, therefore there cannot be any dependency between non-prime columns.</li>
</ul>
<p><span class="math inline">\(R\)</span> is in BCNF because:</p>
<ul>
<li>The only functional dependency <span class="math inline">\(AB \rightarrow C\)</span> has a key as its determinant.</li>
</ul>
<p>Similarly, for <span class="math inline">\(R_1\)</span>.</p>
</div>
</details>
</div>
<div id="question-4" class="section level1">
<h1>Question 4</h1>
<p>We consider the following table:</p>
<pre><code>Patient (ssn, first_name, last_name, phone_number, insurance_number, 
         insurance_expiration_date)</code></pre>
<p>where the following set <span class="math inline">\(\mathcal{F}\)</span> of functional dependencies holds:</p>
<pre><code>ssn -&gt; first_name, last_name, phone_number, insurance_number, 
       insurance_expiration_date 

insurance_number -&gt; insurance_expiration_date</code></pre>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<span id="exr:unnamed-chunk-9" class="exercise"><strong>Exercise 9  </strong></span>Derive a minimal set <span class="math inline">\(\mathcal{G}\)</span> of functional dependencies that is equivalent to <span class="math inline">\(\mathcal{F}\)</span>.
</div>
</div>
<details>
<p><summary>Solution</summary></p>
<div class="infobox exosolution">
<p>First, we need to rewrite the FDs in canonical form.</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(ssn \rightarrow first\_name\)</span></li>
<li><span class="math inline">\(ssn \rightarrow last\_name\)</span></li>
<li><span class="math inline">\(ssn \rightarrow phone\_number\)</span></li>
<li><span class="math inline">\(ssn \rightarrow insurance\_number\)</span></li>
<li><span class="math inline">\(ssn \rightarrow insurance\_expiration\_date\)</span></li>
<li><span class="math inline">\(insurance\_number \rightarrow insurance\_expiration\_date\)</span></li>
</ol>
<p>The determinant of each FD is composed of only one column, therefore
it is already left-irreducible.
It is easy to see that all FDs with <TT>ssn</TT> as a determinant must be
kept (otherwise we lose some information).</p>
<p>By transitivity from 4. and 6. we obtain:</p>
<p><span class="math display">\[ssn \rightarrow insurance\_expiration\_date\]</span></p>
<p>Therefore, <span class="math inline">\(\mathcal{G}\)</span> is obtained from <span class="math inline">\(\mathcal{F}\)</span> by removing 5.</p>
</div>
</details>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<span id="exr:unnamed-chunk-10" class="exercise"><strong>Exercise 10  </strong></span>Given <span class="math inline">\(\mathcal{G}\)</span>, identify the candidate keys in the table <TT>Patient</TT>.
</div>
</div>
<details>
<p><summary>Solution</summary></p>
<div class="infobox exosolution">
<p>From the functional dependencies in <span class="math inline">\(\mathcal{F}\)</span>, it’s easy to see that
that the only column that implies all the others
is <TT>ssn</TT>. Therefore, {<TT>ssn</TT>} is the only candidate key in
this table.</p>
</div>
</details>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<span id="exr:unnamed-chunk-11" class="exercise"><strong>Exercise 11  </strong></span>Specify the normal form of the table <TT>Patient</TT>. Justify your answer.
</div>
</div>
<details>
<p><summary>Solution</summary></p>
<div class="infobox exosolution">
<ul>
<li><p>It is immediate to verify that the table is 1NF.</p></li>
<li><p>The table is 2NF because there is only one candidate key, which is composed of
only one column. Therefore, there cannot be any partial dependency.</p></li>
<li><p>The table is not in 3NF. Indeed, there is a functional dependency
between two non-prime columns:</p></li>
</ul>
<p><span class="math display">\[insurance\_number \rightarrow insurance\_expiration\_date\]</span></p>
</div>
</details>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<span id="exr:unnamed-chunk-12" class="exercise"><strong>Exercise 12  </strong></span>How would you normalize
table <TT>Patient</TT> to BCNF? Justify your answer.
</div>
</div>
<details>
<p><summary>Solution</summary></p>
<div class="infobox exosolution">
<p>The offending functional dependency is:</p>
<p><span class="math display">\[insurance\_number \rightarrow insurance\_expiration\_date\]</span></p>
<p>We need to create another table (let’s call it <TT>Insurance</TT>) that contains
the determinant of the offending functional dependency (insurance_number)
as its primary key.
We need to move the colum (insurance_expiration_date) that depends on insurance_number
from table <TT>Patient</TT> to table <TT>Insurance</TT>.</p>
<p>In summary:</p>
<pre>
<TT>Patient</TT>   (<u>ssn</u>, first_name, last_name, phone_number, insurance_number)
<TT>Insurance</TT> (<u>insurance_number</u>, insurance_expiration_date)
</pre>
<p>Note that the column <em>insurance_number</em> in table <TT>Patient</TT> is foreign key to
the column <em>insurance_number</em> in table <TT>Insurance</TT>.</p>
</div>
</details>
</div>

          </div>

          



          
        </div>

        
      </article>

      

    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academic.min.3da86581634ab22d5bb3fc4505df30a5.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
