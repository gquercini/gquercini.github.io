<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Gianluca Quercini">

  
  
  
    
  
  <meta name="description" content="Kubernetes deployment on Cloud">

  
  <link rel="alternate" hreflang="en-us" href="/courses/cloud-en/kubelab-en/">

  


  
  
  
  <meta name="theme-color" content="rgb(0, 136, 204)">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  


  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu68b06f59cdf252d86e7129a31e131766_426695_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu68b06f59cdf252d86e7129a31e131766_426695_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="/courses/cloud-en/kubelab-en/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Gianluca Quercini">
  <meta property="og:url" content="/courses/cloud-en/kubelab-en/">
  <meta property="og:title" content="Kubernetes deployment on Cloud | Gianluca Quercini">
  <meta property="og:description" content="Kubernetes deployment on Cloud"><meta property="og:image" content="img/map[gravatar:%!s(bool=true) shape:circle]">
  <meta property="twitter:image" content="img/map[gravatar:%!s(bool=true) shape:circle]"><meta property="og:locale" content="en-us">
  
    
    
  

  



  


  


  





  <title>Kubernetes deployment on Cloud | Gianluca Quercini</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Gianluca Quercini</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Gianluca Quercini</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#experience"><span>Experience</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#teaching"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      

      

      

    </ul>

  </div>
</nav>


  

  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      


<script src="/js/toggle-menu.js"></script>







  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">

    <a onclick=open_menu_on_click(this) id="docker-tutorial" class="docs-toc-link" href="/courses/cloud-en/docker-en/">Hands-on Docker</a>
    

  </div>
  
  <div class="docs-toc-item">

    <a onclick=open_menu_on_click(this) id="tutorial-kube" class="docs-toc-link" href="/courses/cloud-en/kubernetes-en/">Docker Compose and Kubernetes</a>
    

  </div>
  
  <div class="docs-toc-item active">

    <a onclick=open_menu_on_click(this) id="lab-kube-en" class="docs-toc-link" href="/courses/cloud-en/kubelab-en/">Kubernetes deployment on Cloud</a>
    

  </div>
  
  
</nav>

    </div>

    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <div class="heading">Cloud computing</div>
          <h1>Kubernetes deployment on Cloud</h1>
          <hr>
          <div class="logo">
            
            </div>

          <div class="article-style">
            
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p><link rel="stylesheet" href="/styles/course.css">
<link rel="stylesheet" href="/styles/cloud-computing.css"></p>
<div id="objectives" class="section level1 unnumbered">
<h1>Objectives</h1>
<p>In this lab assignment you will:</p>
<ul>
<li><p>Build and deploy a multi-service application with <strong>Docker Compose</strong>.</p></li>
<li><p>Deploy a multi-service application on a <strong>local Kubernetes cluster</strong>.</p></li>
<li><p>Deploy a multi-service application on a <strong>Kubernetes cluster</strong> on <strong>Microsoft Azure</strong>.</p></li>
</ul>
</div>
<div id="submission" class="section level1 unnumbered">
<h1>Submission</h1>
<ul>
<li><p>In order to submit your work, you need to answer all the questions
that you <strong><a href="https://centralesupelec.edunao.com/mod/quiz/view.php?id=151760" target="_blank">find here</a></strong>.</p></li>
<li><p><strong>Only one member</strong> of the group must fill in the questionnaire.</p></li>
<li><p>You can answer the open questions either in French or in English.</p></li>
<li><p>Some questions require you to upload files.</p></li>
<li><p>You can pause the test at any moment. Your answers will be stored; you’ll find them when you resume the test.</p></li>
<li><p>After answering the last question, you need to click on the button <em>Terminer le test</em> (<em>Finish attempt</em> if you use the interface in English) to submit the questionnaire.
<strong>The submission is final. After submitting, you cannot change your answers anymore.</strong></p></li>
<li><p><strong>Deadline: 14 May 2025, 23h59</strong></p></li>
</ul>
</div>
<div id="context" class="section level1 unnumbered">
<h1>Context</h1>
<p>We intend to build and deploy a Web application called <em>TripMeal</em> that let users share their favorite recipes.
You can download the application
<a href="/courses/cloud-computing/kube-lab/tripmeal.zip">here</a>.
The source code has been readapted from
<a href="https://github.com/DanielAndreasen/TripMeal" target="_blank">this GitHub repository</a>.</p>
<p>The downloaded file is an archive.
Extracting the archive will create a folder named
<code>tripmeal_sujet</code>.</p>
</div>
<div id="bulding-and-deploying-with-docker-compose" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Bulding and deploying with Docker Compose</h1>
<p>You’re going to build and deploy the application using Docker Compose.
In the folder <code>tripmeal_sujet</code> you should see a file named <em>docker-compose.yml</em>.</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-1" class="exercise"><strong>Exercise 1.1  </strong></span>
Answer on Edunao. What is the file <em>docker-compose.yml</em> used for?</p>
</div>
</div>
<p>Look at the files and folders inside the folder <code>tripmeal_sujet</code>.</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-2" class="exercise"><strong>Exercise 1.2  </strong></span>
Answer on Edunao. How many services does the application <em>TripMeal</em> have?</p>
</div>
</div>
<p>The <code>Dockerfile</code> in the directory <code>db</code> is already implemented.
Open it and read the content to answer the following questions.</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-3" class="exercise"><strong>Exercise 1.3  </strong></span>
Answer on Edunao. Which DataBase Management System (DBMS) is used in the <em>TripMeal</em> application?</p>
</div>
</div>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-4" class="exercise"><strong>Exercise 1.4  </strong></span>
Answer on Edunao. What is the version (tag) of the image used for the database management system of <em>TripMeal</em>?
Find the documentation of the image and use it to answer this question.</p>
</div>
</div>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-5" class="exercise"><strong>Exercise 1.5  </strong></span>
Where does Docker get the base image for the database management system from?</p>
</div>
</div>
<div id="dockerfile-in-folder-web" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Dockerfile in folder <code>web</code></h2>
<p>If you open folder <code>web</code>, you’ll see that the Dockerfile is empty.</p>
<div class="infobox activitybox">
<p><strong>Activity</strong></p>
<p>Complete the <code>Dockerfile</code> in the directory <code>web</code>.</p>
<ul>
<li><p>You need a Python 3.7 environment to run the application.</p></li>
<li><p>The application consists of several files and folders. You need to include all of them into a Docker image.</p></li>
<li><p>Add the following instruction in your Dockerfile:</p></li>
</ul>
<p><code>RUN chmod -x path_to_file_app</code></p>
<p>where <code>path_to_file_app</code> is the path to the file <code>app.py</code> <strong>inside the image</strong>.
This will prevent an <code>Exec format error</code> from occurring.</p>
</div>
<p>Time to make sure that we can build an image from this Dockerfile and we can run a container from that image.</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-6" class="exercise"><strong>Exercise 1.6  </strong></span></p>
<ul>
<li><p>Build an image from the Dockerfile that you’ve just completed using the <code>docker build</code> command.
You can give the image any name you want. For simplicity, I assume that you call it <code>web-test</code>.</p></li>
<li><p>Run a container from this image by typing the following command. The command will only work if you type
it from the directory where the file <code>tripmeal.env</code> is stored.</p></li>
</ul>
<p><code>docker run --env-file tripmeal.env -p 3000:5000 web-test</code></p>
<ul>
<li><p>Open a Web browser and type the following URL: <code>localhost:3000</code>. You should see the interface of the application. If that’s not the case, stop the container,
and correct the Dockerfile.</p></li>
<li><p>If you click on the links <em>New recipe</em>, <em>All recipes</em>, <em>Weekly menu</em> and <em>Login</em> in the application interface, you will get a connection error to the database server.
This is normal and will be fixed later.</p></li>
</ul>
<p>If the image passes the test, <strong>upload the Dockerfile to Edunao.</strong></p>
</div>
</div>
</div>
<div id="the-environment-variables" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> The environment variables</h2>
<p>When testing the image of the service <code>web</code>, you may have noticed that we passed the file <code>tripmeal.env</code> as an argument to the command <code>docker run</code>.
This file contains the definition of <strong>environment variables</strong> that are used in the application.
Open this file and look at the environment variables to answer the following questions.</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-7" class="exercise"><strong>Exercise 1.7  </strong></span>
Answer on Edunao. What does the environment variable SERVER_PORT refer to?</p>
</div>
</div>
<!-- ::: {.infobox .exercisebox data-latex="{exercisebox}"}
**Exercise**


\BeginKnitrBlock{exercise}<div class="exercise"><span class="exercise" id="exr:unnamed-chunk-8"><strong>(\#exr:unnamed-chunk-8) </strong></span>
Answer on Edunao. Which of the following sentences are true?

a. When you execute TripMeal, SERVER_PORT will be opened on the network interface of the host computer (your computer).

b. When you execute TripMeal, SERVER_PORT will be opened on the network interface of a container.

c. In order to access the Web interface of TripMeal, you'll need to map SERVER_PORT to a port number p; p will be opened on the network interface of the host computer (your computer).

d. When you execute TripMeal, you'll be able to access the Web interface by typing the URL localhost:$SERVER_PORT in your browser.

</div>\EndKnitrBlock{exercise}

:::

 -->
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-9" class="exercise"><strong>Exercise 1.8  </strong></span>
Answer on Edunao.
When you write the file <code>docker-compose.yml</code>, you’ll need to give the database service a name.
Which of the environment variables tells you the name that you must use?</p>
</div>
</div>
</div>
<div id="volumes-and-networks" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Volumes and networks</h2>
<p>The <em>TripMeal</em> application keeps user information and recipe information in a database.
Therefore, you’ll need to define a Docker <strong>volume</strong> to hold the data.</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-10" class="exercise"><strong>Exercise 1.9  </strong></span>
Answer on Edunao. Look at the documentation of the base image of the database management system of the application.
Which directory inside the database image will you attach the volume to?</p>
</div>
</div>
<p>The containers composing the <em>TripMeal</em> application need to communicate through a Docker <strong>network</strong>.</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-11" class="exercise"><strong>Exercise 1.10  </strong></span>
Answer on Edunao. If you don’t explicitly create any network, the containers will be able to communicate anyway.
How do you explain it?</p>
<p><strong>Note.</strong> You can answer this question after writing the Docker compose file and running the application.</p>
</div>
</div>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-12" class="exercise"><strong>Exercise 1.11  </strong></span>
Answer on Edunao. Why is not creating a network for the application considered a bad idea,
even if the application works?</p>
</div>
</div>
</div>
<div id="the-compose-file" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> The compose file</h2>
<p>You’re finally ready to complete the file <code>docker-compose.yml</code>.</p>
<div class="infobox activitybox">
<p><strong>Activity</strong></p>
<p>Write the file <code>docker-compose.yml</code>.</p>
<ul>
<li><p>Remember that you need to pass the <strong>environment variables</strong>
to your application.</p></li>
<li><p>As a documentation of Docker Compose you can use:</p>
<ul>
<li><p>The <a href="/courses/cloud-computing/tutorials/tutorial-kube" target="_blank">examples that we’ve seen together</a>.</p></li>
<li><p>The overview presented on the <a href="https://docs.docker.com/compose/" target="_blank">official Docker website</a>.</p></li>
<li><p>You can also find the full specification of Compose <a href="https://github.com/compose-spec/compose-spec/blob/master/spec.md" target="_blank">here</a>.</p></li>
</ul></li>
<li><p>Run the application and test it. You should be able to see the Web interface of the application, create an account, share a recipe and
look at the list of shared recipes.</p></li>
<li><p>If you experience problems, you might find the command <code>docker-compose logs</code> useful.</p></li>
</ul>
</div>
<p>If you successfully deployed the application, you can continue.</p>
<div class="infobox warning">
<p><strong>Shut down the application!</strong></p>
<p>Shut down both the application before you move on.</p>
</div>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-13" class="exercise"><strong>Exercise 1.12  </strong></span>
Upload your file <code>docker-compose.yml</code> to Edunao.</p>
</div>
</div>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-14" class="exercise"><strong>Exercise 1.13  </strong></span>
<u>Use Docker Compose</u> to push all the images that you built in this section to
your DockerHub registry.</p>
<p><strong>In the answer to this exercise write the link to the uploaded images.</strong></p>
</div>
</div>
</div>
</div>
<div id="local-kubernetes-cluster" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Local Kubernetes cluster</h1>
<p>We intend to deploy the application <em>TripMeal</em> on
a <strong>local Kubernetes cluster</strong> (either Docker Desktop or Minikube).</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-15" class="exercise"><strong>Exercise 2.1  </strong></span>
Answer on Edunao. For each service of the application <em>TripMeal</em>, specify
the Kubernetes objects that you need to create and their types.
Justify your answers.</p>
</div>
</div>
<div id="environment-variables" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Environment variables</h2>
<p>One way to pass the environment variables to the containerized applications is to
use a special Kubernetes resource called a <strong>ConfigMap</strong>.
The following is an example (taken from <a href="https://www.techworld-with-nana.com/post/kubernetes-configmap-and-secret-explained" target="_blank">here</a>)
of a ConfigMap with a database connection configuration:</p>
<pre class="yml"><code>apiVersion: v1
kind: ConfigMap
metadata:
    data: my-config
data:
    db-host: &quot;cluster-mysql.database&quot;
    db-port: &quot;3306&quot;
    db-name: &quot;my-db&quot;</code></pre>
<p>In the specification of this ConfigMap, we indicate:</p>
<ul>
<li>The name of the ConfigMap (in the <code>metadata</code> field);</li>
<li>The values of some configuration keys (in the <code>data</code> section).</li>
</ul>
<p>It is advisable to write the specification of a ConfigMap in <strong>its own file</strong> (for example <code>my-config.yml</code>).</p>
<p>The ConfigMap is then used in the specification of a Pod, as the following example shows.</p>
<pre class="yml"><code>apiVersion: v1
kind: Pod
metadata:
   name: my-app
spec:
   containers:
   - name: my-app
     image: my-app-image
     env:
     - name: DB_HOST
         valueFrom:
            configMapKeyRef:
               name: my-config
               key: db-host
    - name: DB_PORT
         valueFrom:
            configMapKeyRef:
               name: my-config
               key: db-port
    - name: DB_NAME
         valueFrom:
            configMapKeyRef:
               name: my-config
               key: db-name      </code></pre>
<p>In this specification, the environment variables are all defined in section <code>env</code>.
For each environment variable (for instance, DB_HOST), we give its name, the
reference to the ConfigMap (<code>my-config</code> in our example) and the key in the
ConfigMap (<code>db-host</code>) that holds the value of the variable.</p>
<p>Let’s now create a ConfigMap for the application TripMeal!</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-16" class="exercise"><strong>Exercise 2.2  </strong></span>
Create a file <code>tripmeal-env.yml</code> and write the specification of a ConfigMap
to set the values of the environment variables listed in file <code>tripmeal.env</code>.</p>
<ul>
<li><p>Create the ConfigMap using the command <code>kubectl apply -f tripmeal-env.yml</code>.</p></li>
<li><p>Check that the ConfigMap is created with the command <code>kubectl get ConfigMap</code>.</p></li>
<li><p><strong>Upload the file to Edunao.</strong></p></li>
</ul>
</div>
</div>
<p>We now deploy the Web interface.</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-17" class="exercise"><strong>Exercise 2.3  </strong></span>
Create a file <code>tripmeal-kube.yml</code> and write the specification of the necessary resources to deploy the
web interface (ignore the database for now).
Use the ConfigMap that you created in the previous exercise to set the value of the necessary environment variables.</p>
<ul>
<li>Deploy the web interface via the command:</li>
</ul>
<p><code>kubectl apply -f tripmeal-kube.yml</code></p>
<ul>
<li>Confirm that you can access the home page of the web interface using your browser (it is normal if you get an error if you try to log in or use any functionality that triggers an action on the database).</li>
</ul>
</div>
</div>
<p>Now we deploy the DBMS.</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-18" class="exercise"><strong>Exercise 2.4  </strong></span>
Add to file <code>tripmeal-kube.yml</code> the specification of the necessary resources to deploy the
DBMS.
Use the ConfigMap that you created in the previous exercise to set the value of the necessary environment variables.</p>
<ul>
<li>Deploy the DBMS via the command:</li>
</ul>
<p><code>kubectl apply -f tripmeal-kube.yml</code></p>
<ul>
<li>Confirm that all functionalities of the application work as intended.</li>
</ul>
<p><strong>Upload the file <code>tripmeal-kube.yml</code> to Edunao.</strong></p>
</div>
</div>
</div>
<div id="secrets" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Secrets</h2>
<p>In the previous section, we used ConfigMaps to pass sensitive information (such as the database username and the password)
to the application.
Sensitive information are better handled with another Kubernetes resource called a <strong>Secret</strong>.</p>
<p>The specification of a secret is similar to a ConfigMap’s.</p>
<pre class="yml"><code>apiVersion: v1
kind: Secret
metadata:
    data: my-secret
type: Opaque
data:
    db-user: &quot;myusername&quot;
    db-pwd: &quot;mypwd&quot;</code></pre>
<p>The type Opaque refers to the fact that this secret stores unstructured key-value pairs. Other types exist that constrain the
content of the secret to a more specific format.</p>
<div class="infobox activitybox">
<p><strong>Activity</strong></p>
<p>Copy this specification to a file named <code>mysecret.yml</code> and
create the secret with the following command:</p>
<p><code>kubectl apply -f mysecret.yml</code></p>
<p>Then show the specification of the secret with the following command:</p>
<p><code>kubectl get secret my-secret -o yaml</code></p>
<p>Look at the section <code>data</code>: both username and password are stored using the <strong><a href="https://en.wikipedia.org/wiki/Base64#Output_padding" target="_blank">base64 encoding</a></strong>.</p>
</div>
<p>It is important to note that the base64 encoding is <strong>not an encryption method</strong>.
In other words, Kubernetes stores all secrets in <strong>plain text by default</strong> in the <code>etcd</code> database .</p>
<div class="infobox activitybox">
<p><strong>Good to know</strong></p>
<p>The correct management of secrets is a complex topic that is out of the scope of this course.
One essential step to ensure a correct secret management is
enabling <strong>encryption at rest</strong> in Kubernetes.
This is done by applying a configuration on the Kubernetes node that runs the
<code>api-server</code>; this configuration must specify the encryption key used to encrypt all secrets
to store them safely in etcd.</p>
<p>Two options exist:</p>
<ul>
<li>the encryption key is stored in plain text in the node. As long as unauthorized users cannot access the node, the key is safe, but this solution is clearly not a perfect solution.</li>
<li>the encryption key is managed by an external key management server (KMS). In this option, a different encryption key (Data Encryption Key, or DEK) is generated for each secret; the secret is encrypted with DEK.
The DEK is also encrypted with another key (Key Encryption Key, or KEK); both the encrypted secret and the encrypted DEK are stored on the key management server. This option has the advantage of
using a different key for each secret.</li>
</ul>
<p>Encryption at rest cannot be applied on Kubernetes deployed in Docker Desktop.
When deploying to Azure, encryption at rest can be enabled and Kubernetes can be configured to use Azure Key Vault as key management server.</p>
<p>For an in-depth coverage of Kubernetes secrets management, refer <a href="https://learning.oreilly.com/library/view/kubernetes-secrets-management/9781617298912/" target="_&quot;blank&quot;">to this book</a>.</p>
</div>
<p>The following specification shows an example of how to use a secret in a Pod’s specification:</p>
<pre class="yml"><code>apiVersion: v1
kind: Pod
metadata:
   name: my-app
spec:
   containers:
   - name: my-app
     image: my-app-image
     env:
     - name: DB_USER
         valueFrom:
            secretKeyRef:
               name: my-secret
               key: db-user
    - name: DB_PASSWORD
         valueFrom:
            secretKeyRef:
               name: my-secret
               key: db-pwd
    </code></pre>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-19" class="exercise"><strong>Exercise 2.5  </strong></span>
Using the examples shown above:</p>
<ul>
<li><p>define a secret specification for the database user and password in a new file <code>tripmeal-secret.yml</code>.</p></li>
<li><p>modify the specification of your Pods in file <code>tripmeal-kube.yml</code> to use the secret to set the database user and password.</p></li>
<li><p>remember to <strong>remove</strong> the definition of the environment variables for the database user and password from file <code>tripmeal-env.yml</code>.</p></li>
</ul>
<p><strong>Apply the changes</strong> and confirm that the application works as intended.</p>
<p><strong>Upload the files : <code>tripmeal-secret.yml</code>, <code>tripmeal-kube.yml</code> and <code>tripmeal-env.yml</code> to Edunao.</strong></p>
</div>
</div>
<div class="infobox warning">
<p><strong>Shut down the application!</strong></p>
<p>Shut down the application by removing all the Kubernetes objects.</p>
</div>
</div>
</div>
<div id="kubernetes-cluster-on-microsoft-azure" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Kubernetes cluster on Microsoft Azure</h1>
<p>At this point you should have successfully deployed the application on your local Kubernetes cluster.</p>
<p>You’re now going to create a Kubernetes cluster on <strong>Microsoft Azure</strong>
and deploy <em>TripMeal</em> on that cluster.</p>
<div class="infobox warning">
<p><strong>Warning</strong></p>
<p>If you haven’t activated it yet:</p>
<ul>
<li><p>Connect to <a href="https://azure.microsoft.com/en-us/free/students/" target="_blank">this webpage</a>.</p></li>
<li><p>Click on <code>Start free</code>.</p></li>
<li><p>Sign in by using your CentraleSupélec credentials.</p></li>
<li><p>Follow the instructions.</p></li>
</ul>
</div>
<p>During this activity, you’ll need to answer some questions that encourage you to
gain a deeper knowledge of the Azure platform and better understand the commands that you type.
<strong>Feel free to read the documentation on the Azure platform in order to answer the questions.</strong></p>
<div id="login-to-azure-through-cli" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Login to Azure through CLI</h2>
<div class="infobox warning">
<p><strong>Warning</strong></p>
<p>If you get the message <em>command not found</em> when you type <code>az</code>, it means that you haven’t installed
the Azure CLI yet.
You’ll find more information on the <a href="https://centralesupelec.edunao.com/course/view.php?id=8081#section-4" target="_blank">Edunao course page</a>.</p>
<p>Make sure you run version 2.25 or higher of the Azure CLI, by typing:</p>
<p><code>az --version</code></p>
<p><strong>If you use a VM with Multipass you’ll need to install the Azure CLI with the following command:</strong></p>
<p><code>curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash</code></p>
<p><strong>If you use a VM either with Multipass or with VirtualBox you’ll need to re-install kubectl:</strong></p>
<ul>
<li>Type the following command so as the command <code>kubectl</code> does not refer to <code>minikube kubectl</code> anymore:</li>
</ul>
<p><code>unalias kubectl</code></p>
<ul>
<li>Type the following command to install a new version of <code>kubectl</code>:</li>
</ul>
<p><code>sudo az aks install-cli</code></p>
</div>
<p>Whether you’re on Windows, macOS or Linux, you need to <strong>open a terminal</strong>.</p>
<p>In order to log in to your Azure account, type the following command:</p>
<p><code>az login</code></p>
<p>A Web page will open in your default Web browser, where you can type your username and
password (your CentraleSupélec credentials).
After authenticating your Azure account, you can go back to the terminal, where you should see
some information about your account, such as:</p>
<pre><code>[
  {
    &quot;cloudName&quot;: &quot;AzureCloud&quot;,
    &quot;homeTenantId&quot;: &quot;&lt;id&gt;&quot;,
    &quot;id&quot;: &quot;&lt;id&gt;&quot;,
    &quot;isDefault&quot;: true,
    &quot;managedByTenants&quot;: [],
    &quot;name&quot;: &quot;Azure for Students&quot;,
    &quot;state&quot;: &quot;Enabled&quot;,
    &quot;tenantId&quot;: &quot;&lt;id&gt;&quot;,
    &quot;user&quot;: {
      &quot;name&quot;: &quot;&lt;email-address&gt;&quot;,
      &quot;type&quot;: &quot;user&quot;
    }
  }
]</code></pre>
</div>
<div id="deploy-and-use-azure-container-registry" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Deploy and use Azure Container Registry</h2>
<p>When we run TripMeal on a local Kubernetes cluster, we assumed that our computer
could have a direct access to the Internet and, therefore, to the DockerHub registry, where we
could pull the images of the TripMeal services.
When we run a containerized application in production, we cannot make this assumption
as the production servers have often no direct access to the Internet.</p>
<p>We need to place the images in a container registry that is in the same context
as our production servers.
Since we’re going to run the application on Azure, we can use the
<strong>Azure Container Registry (ACR)</strong>.</p>
<div id="registry-creation" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Registry creation</h3>
<p>First, we need to create a <strong>resource group</strong>.</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-20" class="exercise"><strong>Exercise 3.1  </strong></span>
Answer on Edunao. What is a <strong>resource group</strong> in Azure and how is it useful?</p>
</div>
</div>
<p>The command to create a new resource group is the following
(replace RES_GRP_NAME with a name of your choice).</p>
<p><code>az group create --name  RES_GRP_NAME --location francecentral</code></p>
<div class="infobox warning">
<p><strong>Warning</strong></p>
<p>If <code>francecentral</code> does not work for your account, the previous command will normally suggest a possible location.
Choose one that is near you.</p>
</div>
<p>You can verify that the resources are correctly created by looking <a href="https://portal.azure.com/" target="_blank">in the Azure portal</a>.</p>
<p>Next, we need to create a <strong>container registry</strong> with the following command
(replace RES_GRP_NAME with the name of your resource group and REG_NAME with a name of your choice for the registry).</p>
<p><code>az acr create --resource-group RES_GRP_NAME --name REG_NAME --sku Basic</code></p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-21" class="exercise"><strong>Exercise 3.2  </strong></span>
In the previous command, we used the option <code>sku</code>. Answer to a question on Edunao.</p>
</div>
</div>
</div>
<div id="registry-login" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Registry login</h3>
<p>After creating the registry, we can log into it with the following command:</p>
<p><code>az acr login --name REG_NAME</code></p>
</div>
<div id="image-tagging" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Image tagging</h3>
<p>We’re almost ready to push the images that compose the application <em>TripMeal</em> to the registry.
In order to do that, we need to <strong>tag</strong> (i.e., rename) our images so that their names are
preceded by the <strong>login server name</strong> of the registry.</p>
<p>In order to get the name of the <strong>login server name</strong>
(that we denote here as <code>acrloginserver</code>) of your registry, you can type
the following command:</p>
<p><code>az acr list --resource-group RES_GRP_NAME --query "[].{acrLoginServer:loginServer}" --output table</code></p>
<p>Your <code>acrloginserver</code> will be something like <code>xxx.azurecr.io</code>.</p>
<div class="infobox activitybox">
<p><strong>Activity</strong></p>
<p>Tag the images that correspond to the services of the application <em>TripMeal</em> so that
their name is similar to: <code>acrloginserver/nameofimage:latest</code>. You can use the
command <code>docker tag</code>.</p>
</div>
</div>
<div id="pushing-the-images" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Pushing the images</h3>
<p>We can push the images with the following command (use your image name
instead of <code>xxx.azurecr.io/imagename:latest</code>).</p>
<p><code>docker push xxx.azurecr.io/imagename:latest</code></p>
<p>Make sure to <strong>type this command for each image</strong> that you want to push.</p>
<div class="infobox warning">
<p><strong>Warning</strong></p>
<p>It might take few minutes before the images are completely pushed to the registry.</p>
</div>
<p>Finally, verify that the images are actually in the registry with the following command:</p>
<p><code>az acr repository list --name REG_NAME --output table</code></p>
<p>Alternatively, you can connect to <a href="https://portal.azure.com/" target="_blank">your Azure portal</a>
and visually browse your resources.</p>
</div>
</div>
<div id="deploy-a-kubernetes-cluster" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Deploy a Kubernetes cluster</h2>
<p>We now deploy a <strong>Kubernetes cluster on Azure</strong>.</p>
<div id="cluster-creation" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Cluster creation</h3>
<p>We create the cluster with the following command (replace CLUSTER_NAME
with a name of your choice. As before, RES_GRP_NAME is the name of your resource group
and REG_NAME is the name of the container registry).</p>
<pre class="bash"><code>az aks create \
    --resource-group RES_GRP_NAME \
    --name CLUSTER_NAME \
    --node-count 2 \
    --generate-ssh-keys \
    --attach-acr REG_NAME</code></pre>
<div class="infobox warning">
<p><strong>Warning</strong></p>
<p>If you get an error on your SSH key, then your key is not in the right format.</p>
<p>Here is how we suggest you to proceed.</p>
<ol style="list-style-type: decimal">
<li><p>Open your home directory in Visual Studio.</p></li>
<li><p>Locate the hidden folder <code>.ssh</code>.</p></li>
<li><p>You should have a file named <code>id_rsa.pub</code> under folder <code>.ssh</code>. Open it.</p></li>
<li><p>Copy the whole content of the file.</p></li>
<li><p>Create a new file under folder <code>.ssh</code>. Give it a name of your choice (for instance, <code>id_kube_rsa.pub</code>).</p></li>
<li><p>Paste the content into the new file, while making sure that you don’t have any whitespace before
the first character.</p></li>
<li><p>Save and close the file.</p></li>
<li><p>Type the command <code>az aks create</code> and replace the <code>--generate--ssh-keys</code> option with <code>--ssh-key-value ~/.ssh/id_kube_rsa.pub</code>.</p></li>
</ol>
</div>
<p>The cluster will take a while to start. Time for a coffee!
But before, answer the following question!</p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-23" class="exercise"><strong>Exercise 3.3  </strong></span>
What is the meaning of the option <code>node-count</code> in the previous command?</p>
</div>
</div>
</div>
<div id="connect-to-the-cluster" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Connect to the cluster</h3>
<p>We can configure <code>kubectl</code> to connect to the newly created cluster.
You need to type the following command:</p>
<p><code>az aks get-credentials --resource-group RES_GRP_NAME --name CLUSTER_NAME</code></p>
<p>Now, your Kubernetes cluster should be visible locally.
To verify it, type the following command:</p>
<p><code>kubectl config get-contexts</code></p>
<p>Here <em>context</em> refers to the Kubernetes clusters that <em>kubectl</em> has access to.
The Kubernetes cluster that you created on Azure should be visible in the output; an asterisk
should appear in front of its name, indicating that it is the <em>current context</em>
(that is the Kubernetes cluster being currently referenced by <code>kubectl</code>).</p>
<p>Type the following command:</p>
<p><code>kubectl get nodes</code></p>
<p>You should see the information about the nodes in the cluster.</p>
</div>
</div>
<div id="deploy-the-application" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Deploy the application</h2>
<p>We’re almost done! The images are in the registry, the Kubernetes cluster is up and running.
The only missing piece of the puzzle is our application <em>TripMeal</em>.</p>
<p>First thing to do is to slightly modify the file <code>tripmeal.yml</code> that you created at the end
of the previous section.</p>
<div class="infobox activitybox">
<p><strong>Activity</strong></p>
<p>Look at the names of the images of each service in that file. How must these names change?
Modify the file accordingly (<strong>no need to upload it on Edunao</strong>).</p>
</div>
<p>It is the moment you’ve been waiting for!
Deploy your application by typing the following command:</p>
<p><code>kubectl apply -f tripmeal.yml</code></p>
<p>Look at Kubernetes objects created after this command:</p>
<p><code>kubectl get all</code></p>
<p>Wait for all the components to be up and running.
Get the external IP address of the web service and try to connect to the application,
in the same way you did in the previous section.</p>
<p><strong>If you can play with the application like you did in your local deployment it means that you reached
the conclusion of this assignment! Bravo!</strong></p>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-24" class="exercise"><strong>Exercise 3.4  </strong></span>
Submit a <strong>video</strong> like that the one that <a href="https://webtv.centralesupelec.fr/permalink/v1261a00b74dbbzwk2vr/" target="_blank"><strong>you can see here</strong></a>.</p>
<p>The video must <strong>clearly</strong> show that:</p>
<ul>
<li><p>You’re connected to <strong>your Azure portal</strong> (Email address on the top right corner of the portal).</p></li>
<li><p>All the passages that you see in the sample video: you need to show the <strong>public IP address</strong>
of the application that you deployed, use that address to connect to your application and play
with the application to show that it works correctly.</p></li>
</ul>
</div>
</div>
<div class="infobox exercisebox">
<p><strong>Exercise</strong></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-25" class="exercise"><strong>Exercise 3.5  </strong></span></p>
<p>You can access your application using the IP address followed by the port number.
It would be cool if you could access the application by typing an URL, and without specifying a port number.</p>
<p>Modify the specification of your Kubernetes external service to allow the connection to your app via an URL. Here are some hints:</p>
<ul>
<li><p>You can use the field <code>service.beta.kubernetes.io/azure-dns-label-name</code>.</p></li>
<li><p>Get some help from ChatGPT to set up the value of this field and find out the URL that you’ll need to type to access the app.</p></li>
</ul>
<p><strong>Upload your specification file on Edunao.</strong></p>
</div>
</div>
</div>
</div>
<div id="conclusion" class="section level1 unnumbered">
<h1>Conclusion</h1>
<p>Make sure you follow these instructions:</p>
<ul>
<li>Take down your application in Kubernetes by using the following command:</li>
</ul>
<p><code>kubectl delete -f tripmeal.yml</code></p>
<ul>
<li>Change the context of the <code>kubectl</code> command so that it points back
to a local Kubernetes cluster. Type the following command, where
CONTEXT_NAME will be <code>docker-desktop</code> or <code>minikube</code>, depending on which local Kubernetes cluster
you use.</li>
</ul>
<p><code>kubectl config use-context CONTEXT_NAME</code></p>
<ul>
<li><strong>Destroy all the resources</strong> linked to the application
<em>TripMeal</em> on Microsoft Azure, otherwise you’ll get billed even if you don’t use them!
You can destroy all the resources by simply deleting the resource group to which they belong.
You can do it through the Azure portal or by typing the following command (replace RES_GRP_NAME with the name
of the resource group that you intend to remove).</li>
</ul>
<p><code>az group delete --name RES_GRP_NAME</code></p>
<ul>
<li><p>You can check the balance of your Azure credit <a href="https://www.microsoftazuresponsorships.com/Balance" target="_blank">here</a>.</p></li>
<li><p>You can stop Docker and Kubernetes if you don’t need it anymore.</p></li>
</ul>
<!-- https://stackoverflow.com/questions/55271912/flask-cli-throws-oserror-errno-8-exec-format-error-when-run-through-docker-->
<!-- merge 1.2 with 1.3, so that we can ask students to point out exactly the common layers -->
<!-- # Docker networking model

We developed a simple chat room in Python that you can download 
[here](/courses/cloud-computing/kube-lab/chat-room.zip). 
The code has been adapted from [this GitHub project](https://github.com/pricheal/python-client-server/){target="_blank"}.

Participants use a *client* program to connect to the chat room;
the chat room is managed by a *server* application  that receives the 
client connections and forwards the messages between the users.
The archive contains the following files:

* *client.py*. Implementation of the chat room client.
* *server.py*. Implementation of the chat room server.
* *utils.py*. Library with utility functions used in both *client.py* and *server.py*.

The application is written in Python and it **requires Python 3.7**. 
The application doesn't need any third-party library, the packages included in a minimal Python environment are enough.




::: {.infobox .exercisebox  data-latex="{exercisebox}"}
**Exercise**


\BeginKnitrBlock{exercise}<div class="exercise"><span class="exercise" id="exr:client-server-methodology"><strong>(\#exr:client-server-methodology) </strong></span> 

a. Is a single Docker image for this application enough? Justify your answer.

b. Given your answer to the previous question, how many Docker images do you need to create? 
</div>\EndKnitrBlock{exercise}


:::



We now build the images for the application.

:::{.infobox .curiosity data-latex="curiosity"}
**Good to know**

If you need to inspect the file system of an
image that you create (e.g., to verify that the files that you 
copied are actually there), you can open a terminal 
in the image by using the following command:

``
docker run -it --entrypoint sh IMAGE_NAME
``

:::


::: {.infobox .exercisebox data-latex="{exercisebox}"}
**Exercise**


\BeginKnitrBlock{exercise}<div class="exercise"><span class="exercise" id="exr:unnamed-chunk-26"><strong>(\#exr:unnamed-chunk-26) </strong></span>Build the image(s) for the application. For each image:

a. Upload the Dockerfile to Edunao.
b. Write the **exact** command that you used to build the image.
</div>\EndKnitrBlock{exercise}

::: {.infobox .warning data-latex="{warning}"}
**Warning**

The size of the images should be kept as small as possible.
Remember to include in the images only what you need to build and run the application.

:::

If you built more than one image:

c. Do they have some common layers? Which ones?

d. If so, is it something that has an impact on the build time and how?

:::








## Client and server on the same network

We want to execute:

* One instance of the server.

* Two instances of the client.

The server, as well as the clients, will 
**run in Docker containers attached to the same network**.


::: {.infobox .exercisebox data-latex="{exercisebox}"}
**Exercise**

\BeginKnitrBlock{exercise}<div class="exercise"><span class="exercise" id="exr:unnamed-chunk-27"><strong>(\#exr:unnamed-chunk-27) </strong></span>
We want to make sure that:

1. The server and the clients can communicate with each other.

2. Other Docker containers **cannot** communicate neither with the server nor with the clients.  

How can you satisfy both requirements in Docker? Explain your solution 
and justify it.
</div>\EndKnitrBlock{exercise}

:::



::: {.infobox .warning data-latex="{warning}"}
**Warning**

Only one instance of the server is running. 
Two instances of the client run at the same time.

1. In order to execute the server, we need to **pass a port number as a parameter**. Choose one in the range [49152–65535].

2. In order to execute the client, we need to **pass as parameters the IP address of the server and the port** which the server listens to (the one that you specified at 1.).

:::




::: {.infobox .exercisebox data-latex="{exercisebox}"}
**Exercise**

\BeginKnitrBlock{exercise}<div class="exercise"><span class="exercise" id="exr:client-server-single-network"><strong>(\#exr:client-server-single-network) </strong></span>
Execute the server and the two clients by using the network configuration that you
explained in the previous exercise.

* The server writes messages on the terminal. Remember to launch the container with the appropriate 
options in order to actually see those messages.

* Users need to interact with the client, that is: read and write messages. 
Remember to launch the container with the appropriate options in order to actually see those messages.

Write the **exact commands** that you typed for 
both configuring the network and launching the server and the clients.  **Explain these commands.**
</div>\EndKnitrBlock{exercise}

:::



::: {.infobox .warning data-latex="{warning}"}
**Shut the application down!**

Shut both the clients and the server down  before you move on.

* On the client-side, type ``#quit`` at any moment to exit the chat room.

* Type Ctrl-C to stop the server.

:::


## Client and server on different networks

We want to execute:

* One instance of the server.

* Two instances of the client.

However, **neither client** is connected to the same network as the server.

::: {.infobox .exercisebox data-latex="{exercisebox}"}
**Exercise**


\BeginKnitrBlock{exercise}<div class="exercise"><span class="exercise" id="exr:unnamed-chunk-28"><strong>(\#exr:unnamed-chunk-28) </strong></span>
Why can't you launch the containers with the same settings as 
in Exercise \@ref(exr:client-server-single-network)?

What do you propose as a solution instead?

</div>\EndKnitrBlock{exercise}

:::






::: {.infobox .exercisebox data-latex="{exercisebox}"}
**Exercise**


\BeginKnitrBlock{exercise}<div class="exercise"><span class="exercise" id="exr:unnamed-chunk-29"><strong>(\#exr:unnamed-chunk-29) </strong></span>
Execute the server and the two clients by making sure that neither client is connected to the 
same network as the server.

Write the **exact commands** that you typed 
for both configuring the network and launching the server and the clients.
**Explain these commands.**

</div>\EndKnitrBlock{exercise}

:::



::: {.infobox .warning data-latex="{warning}"}
**Shut the application down!**

Shut both the clients and the server down before you move on.

* On the client-side, type ``#quit`` at any moment to exit the chat room.

* Type Ctrl-C to stop the server.

::: -->
</div>

          </div>

          



          
        </div>

        
      </article>

      

    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academic.min.3da86581634ab22d5bb3fc4505df30a5.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
